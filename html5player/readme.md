### Html5 barrage player html5弹幕播放器（测试中）

##### 实地测试地址
###### 从右至左，上部悬停，下部悬停弹幕测试
http://mea.moe/kagariProject/html5player/html5player.html 视频源为“Fate/kaleid liner プリズマ☆イリヤ 2wei Herz 命短し腐れよ乙女”（魔法少女伊莉娅第三期）的第三集
###### 增加高级弹幕（目前只有字幕弹幕）
http://mea.moe/kagariProject/html5player/html5player2.html 视频源为“フタコイ オルタナティブ ED ぼくらの時間”（双恋 Alternative ED）   

##### 已完成的：
1. Chrome、Firefox、IE测试通过（Chrome 48.0.2564.116，Firefox 44.0.2，IE 11.0.28），Edge卡顿严重（摇头，还是等微软更新版本的Edge吧）
2. 弹幕格式（已完成：从右至左，上部悬停，下部悬停）
3. 弹幕大小（Chrome与Firefox最小取决于你浏览器的设定，最大30pt。IE最小字号尚不清楚，最大30pt。）
4. 发送弹幕显示（目前还没有发弹幕加个框这个想法）
5. 弹幕颜色（目前只支持#FFFFFF这种颜色代码模式）
6. 弹幕存储（使用php写入本地文件，数据库太麻烦）

##### 未完成的：
1. 视频选择（这个问题可能到时候根本就不关心）
2. 各种选项设置（完全没想法）
3. 高级弹幕（目前字幕调bug中……莫名其妙的过不了啊！！想看文档但是发现自己根本没有写！！）

##### 目前遇到的问题及待改进方向
1. ~~Chrome播放一些小分辨率的时候会出现下部分出现彩条的情况，比如实地测试地址中的那个视频，而Firefox和IE就没有~~(更新到50.0该状况已消失)      
2. IE无法用鼠标选择弹幕模式（可以用键盘），一移动到上面菜单就会消失
3. ~~音量按钮估计要重做（一是太难看二是根本就不好点）~~(已修正)
4. 进度条估计会加上已加载的部分的颜色（现在只有已播放部分和未播放部分两种颜色）  
5. ~~貌似英文和中文间的空格会识别为全角（具体参见OP中“ah 心そっと触れた手に手を重”那一句的显示，明明距离够不知为何要换行）~~（莫名奇妙已修正……）  
6. 现在高级弹幕（字幕版本）不知为何第一条无法正常显示，后面正常！ 
7. backend.php缺乏对提交内容的检验……感觉内容可以写几百行……   
8. 需要对传入弹幕进行时间上的排序，应该会解决6中的问题，还有就是改善性能上的一些问题，可能发送弹幕显示的问题也可以一并解决……    

##### 修补日志
2016.04.10 然而上面的问题一个都不想解决，懒不想动……   
2016.04.29 问题3已修正，问题1已随Chrome版本升级解决（50.0.2661.87），问题5不知道在哪个版本解决了……

##### 注意
鉴于某些人表示不会用，我想说的是你要点“Play”啊！！！！

##### 工作流程
弹幕分为组中弹幕barrageArray这个变量和弹幕池barragePool这个变量。
两个部分：
1. 读取
(1)读取文件（1.js）中的danmuku这个变量，弹幕分为time, type, size, user, color, timestamp, content几个部分。    
(2)type中1为右至左弹幕，2为下方悬停，3为上方悬停，4为高级弹幕。
(3)content即为弹幕内容，高级弹幕有st和ct两个部分，st=stay time，即存在时间；ct=content，即内容
(4)
2. 发送
(2)backend.php文件（是的没办法，只能用后端语言来接受提交数据），用于接受提交弹幕

##### 循环中
第二个视频的音乐，真是太赞！
